env=dev
grp=m365-copilot-$env
loc=westeurope
acct=m365copilot$env
container=food

az group create -n $grp -l $loc

az storage account create -l $loc -n $acct -g $grp --sku Standard_LRS
key=$(az storage account keys list -n $acct -g $grp --query "[0].value" -o tsv)
az storage container create -n $container --account-key $key --account-name $acct

az storage blob upload-batch -d $container -s "assets/images" --account-name $acct --account-key $key

cd food-catalog-api
az webapp up -n food-catalog-api-$env -g $grp -p copilot-food-plan-$env -l $loc -r "dotnet:9"
az webapp cors add --allowed-origins "*" --name food-catalog-api-$env --resource-group $grp
cd ..

cd hr-mcp-server
az webapp up -n hr-mcp-server-$env -g $grp -p copilot-hr-plan-$env -l $loc -r "dotnet:9"
az webapp cors add --allowed-origins "*" --name hr-mcp-server-$env --resource-group $grp
cd ..

cd purchasing-service
az webapp up -n purchasing-service-$env -g $grp -p copilot-purchasing-plan-$env -l $loc -r "dotnet:9"
az webapp cors add --allowed-origins "*" --name purchasing-service-$env --resource-group $grp
cd ..